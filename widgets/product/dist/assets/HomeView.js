import{r as x,d as W,b as Ee,y as I,w as je,e as r,f as i,z as s,N as ze,u as e,K as q,D as T,F as n,G as b,H as S,U as j,V as Ie,W as Ge}from"./embedder.js";import{_ as qe,u as We,a as Je,t as Qe,b as Xe,f as O,P as Ze,g as et}from"./navigation.js";import{c as tt,d as st,s as B,u as $e,U as at,a as lt,b as nt,R as V,P as z,e as Be,B as De,_ as ot}from"./index.js";const rt=async f=>{try{const p=await tt.get(`/vehicleinfo-api/V1/fdm-sis-vehicle-info-by-reg-number/${f}`);return Promise.resolve(p.data)}catch(p){return Promise.reject(p)}},A=st("vehicle",()=>{const f=x(),p=x(!1);return{unknownVehicle:p,vehicleDetails:f,setUnknownVehicle:d=>{p.value=d},getCarDetailsByRegistrationNumber:async d=>{try{const P=await rt(d);return f.value=P.Vehicle,f.value&&(f.value.RegistrationNumber=d),Promise.resolve(f.value)}catch(P){return Promise.reject({type:"CarInfoAPIError",axios:P})}},removeVehicleDetails:()=>{f.value=null}}}),it={class:"flex items-start max-w-sm"},ut=["disabled"],ct={key:0},dt={key:1},vt={class:"fdm-checkbox mt-1 w-full"},mt={key:0,class:"text-fdm-red text-xs font-normal my-0"},ht=W({__name:"UIRegistrationNumber",props:{showValidation:{type:Boolean},viewData:{},placeholder:{}},emits:["input","validated","blur"],setup(f,{emit:p}){const t=p,{appContent:m}=B($e()),{unknownVehicle:c,vehicleDetails:d}=B(A()),{getCarDetailsByRegistrationNumber:P}=A(),g=x(0),R=x(!1),k=x(""),M=x(!1);Ee(()=>{var v;(v=d.value)!=null&&v.RegistrationNumber&&(k.value=d==null?void 0:d.value.RegistrationNumber)});const y=async()=>{try{M.value=!0,await P(k.value).then(v=>{t("input",{vehicleDetails:v,registrationNumber:k.value}),R.value=!1})}catch{R.value=!0,t("input","")}finally{M.value=!1}},U=v=>{k.value=v.value},H=v=>{t("validated",v)},D=()=>{t("blur",{})},F=I(()=>{var v;return!!(c.value||(v=d==null?void 0:d.value)!=null&&v.RegistrationNumber)});return je(c,()=>{c&&(k.value="")}),(v,J)=>{var u,E,$,h;return r(),i("div",null,[s("div",it,[(r(),ze(qe,{class:"relative w-full",label:"Nummerplade",name:"registration-number",maxLength:"7",value:k.value,key:g.value,uppercase:((u=k.value)==null?void 0:u.length)>0,validationTypes:[...F.value?[]:["required"]],showValidation:v.showValidation&&!e(c),infoText:(E=v.viewData)==null?void 0:E.registrationNumberInfoText,disabled:e(c),onInputChanged:U,onInputBlur:D,onValidated:H,onEnter:y,placeholder:v.placeholder},null,8,["value","uppercase","validationTypes","showValidation","infoText","disabled","placeholder"])),s("button",{class:"fdm-button fdm-button--blue border ml-2 mt-6",disabled:e(c)||!k.value,onClick:q(y,["stop","prevent"])},[M.value?(r(),i("span",ct,[T(at,{size:"w-6 h-6",color:"text-white"})])):(r(),i("span",dt,n(($=e(m))==null?void 0:$.labels.search),1))],8,ut)]),s("div",vt,[R.value?(r(),i("p",mt,n((h=e(m))==null?void 0:h.labels.carNotFoundError),1)):b("",!0)])])}}}),_t=["id","value","checked","disabled"],pt=["for"],G=W({__name:"UICheckbox",props:{id:{},label:{},value:{type:Boolean},disabled:{type:Boolean}},emits:["inputChanged"],setup(f,{emit:p}){const t=p;return(m,c)=>(r(),i("div",{class:S(["fdm-checkbox",[m.disabled?"fdm-checkbox--disabled":""]])},[s("input",{type:"checkbox",id:m.id,value:m.value,checked:m.value,disabled:m.disabled,onInput:c[0]||(c[0]=d=>t("inputChanged",{value:m.value,id:m.id}))},null,40,_t),s("label",{for:m.id},n(m.label),9,pt)],2))}}),bt={class:"content"},gt={class:"content__wrapper"},ft={class:"content__box-title mt-12 md:mt-16 mb-6"},xt={key:0},kt={key:1,class:"flex flex-col items-start"},yt={class:"text-base"},Nt={class:"uppercase"},Pt={key:2,class:"flex justify-end items-center"},Tt={class:"flex flex-col items-end"},wt={class:"text-fdm-blue-400 font-bold"},Vt={key:0},Rt={key:1},Mt={key:0,class:"text-sm"},Ct={key:1,class:"text-sm"},It={class:"content__box-title mt-12"},Bt=["innerHTML"],Dt={class:"content__box-container"},Et={class:"text-base font-bold"},$t={class:"flex justify-end items-center"},Lt={class:"flex flex-col items-end"},Ot={class:"text-fdm-blue-400 font-bold"},St=["innerHTML"],At=["onClick"],Ut={class:"text-base font-bold"},Ht={class:"flex justify-end items-center"},Ft={class:"flex flex-col items-end"},Kt={class:"text-fdm-blue-400 font-bold"},Yt={key:0},jt={key:1},zt={key:0,class:"text-sm"},Gt={key:1,class:"text-sm"},qt=["innerHTML"],Wt={class:"mt-1 w-full"},Jt={key:0,class:"text-fdm-red text-xs font-normal my-0"},Qt=W({__name:"HomeView",setup(f){var te,se;const p=lt(),{appContent:t,progressionSteps:m,order:c,orderId:d,config:P,currentProduct:g,optionalProducts:R,offlineSalesMode:k,showOptionalLicensePlateOption:M}=B($e()),{vehicleDetails:y,unknownVehicle:U}=B(A()),{progressStepValue:H,existingMember:D,popoverContent:F,showPopover:v}=B(nt()),{setUnknownVehicle:J}=A(),u=We(),{navigateToNextApp:E,navigateToPreviousApp:$}=Je({basketId:d.value??"",isExistingMember:D.value,isOfflineMode:k.value,crmMessage:(se=(te=t.value)==null?void 0:te.crmFlowMessages)==null?void 0:se.flowCompleted}),h=x(""),Q=x({registrationNumber:!1}),X=x(),N=x(!1),K=x(!1),w=I(()=>t.value?et("productPage",t.value.pages):{});Ee(async()=>{var a,l,_,C;Ke(),Qe({funnelName:P.value.name,stepName:"tilvalg",userType:!!((l=(a=c.value)==null?void 0:a.customer)!=null&&l.fdmNumber),salesType:(_=c.value)==null?void 0:_.salesType,salesChannel:(C=c.value)==null?void 0:C.salesChannel})});const Le=async()=>{var a;try{if(!Y.value){K.value=!0;return}if(await u.updateOrderBasket(),((a=c.value)==null?void 0:a.productPackageType)===z.GREEN){p.push({name:Be.TERMS,query:{basketId:d.value,existing:D.value?"1":"0"}});return}await u.validateCurrentOrder(),E(l=>{F.value=l,v.value=!0})}catch{p.push({name:Be.ERROR})}},Oe=()=>{$()},Z=a=>{var l,_;X.value=a.vehicleDetails,h.value=a.registrationNumber,u.setRegistrationNumber(h.value),u.setCarMake(((l=a.vehicleDetails)==null?void 0:l.Make)??""),u.setCarModel(((_=a.vehicleDetails)==null?void 0:_.Model)??"")},Se=()=>{h.value="",y.value=null,u.setRegistrationNumber("")},L=a=>u.selectedOptions.includes(a),Ae=async(a,l)=>{const _=a.target;_.tagName==="A"||_.tagName==="INPUT"||_.tagName==="BUTTON"||(a.preventDefault(),L(l.productId)?u.removeAddons(l.productId):u.pushAddons(l.productId))},Ue=()=>{u.addOrRemoveMotorMagazine(!u.motorMagasin)},He=()=>{N.value=!N.value,N.value&&(h.value="",u.setRegistrationNumber("")),J(N.value)},Fe=I(()=>{var a;return((a=c.value)==null?void 0:a.productPackageType)===z.GREEN?!(u.selectedOptions.length>=1&&ee.value):!ee.value}),Ke=()=>{var a,l;N.value=U.value,(a=y.value)!=null&&a.RegistrationNumber&&((l=y.value)==null?void 0:l.RegistrationNumber.length)>0&&Z({vehicleDetails:y.value,registrationNumber:y.value.RegistrationNumber})},ee=I(()=>{var l;return N.value&&!h.value||!N.value&&((l=h.value)==null?void 0:l.length)>0}),Y=I(()=>{var l,_;const a=u.selectedOptions.length;return((l=g.value)==null?void 0:l.fdmProductId)===De.KKLAR_EPLUS?a===2:((_=g.value)==null?void 0:_.fdmProductId)===De.KKLAR_EPLUS_UBOKS?a>=1&&a<=2:a>=1});return(a,l)=>{var _,C,ae,le,ne,oe,re,ie,ue,ce,de,ve,me,he,_e,pe,be,ge,fe,xe,ke,ye,Ne;return r(),i(Ie,null,[s("div",null,[s("main",bt,[T(e(Xe),{steps:e(m),"progress-status":e(H)},null,8,["steps","progress-status"]),s("div",gt,[s("h2",ft,n((_=w.value)==null?void 0:_.selectedProductText),1),s("div",{class:S(["content__box",{"content__box--selected":h.value}])},[h.value?(r(),i("div",kt,[s("h2",yt,[j(n((ae=e(t))==null?void 0:ae.labels.registrationNumber)+" ",1),s("span",Nt,n(h.value),1)]),s("span",null,n((le=X.value)==null?void 0:le.AuthorityModelDesignation),1),s("button",{onClick:Se,class:"fdm-text-button mt-4"},n((ne=e(t))==null?void 0:ne.labels.changeVehicle),1)])):(r(),i("div",xt,[T(ht,{modelValue:h.value,"onUpdate:modelValue":l[0]||(l[0]=o=>h.value=o),showValidation:Q.value.registrationNumber,viewData:w.value,onBlur:l[1]||(l[1]=o=>Q.value.registrationNumber=!0),onInput:Z,placeholder:"Ex: AB12345"},null,8,["modelValue","showValidation","viewData"]),e(M)?(r(),i("div",{key:0,class:"flex items-left p-0 mt-2 ml-0",onClick:q(He,["prevent"])},[T(G,{id:"noLicensePlate",value:N.value,label:(C=e(t))==null?void 0:C.labels.noLicensePlate},null,8,["value","label"])])):b("",!0)])),h.value&&e(g)?(r(),i("div",Pt,[s("div",Tt,[s("span",wt,[j(n(e(O)((oe=e(g))==null?void 0:oe.price))+" "+n((re=e(t))==null?void 0:re.labels.dkk),1),((ie=e(g))==null?void 0:ie.recurring)===e(V).MONTHLY?(r(),i("span",Vt,"/"+n((ue=e(t))==null?void 0:ue.labels.month),1)):b("",!0),((ce=e(g))==null?void 0:ce.recurring)===e(V).YEARLY?(r(),i("span",Rt,"/"+n((de=e(t))==null?void 0:de.labels.year),1)):b("",!0)]),((ve=e(g))==null?void 0:ve.recurring)===e(V).ONE_TIME?(r(),i("span",Mt,n((me=e(t))==null?void 0:me.labels.oneTimeBenefit),1)):b("",!0),(he=e(g))!=null&&he.minimumPriceDuringTheBindingPeriod?(r(),i("span",Ct,n(`${(_e=e(t))==null?void 0:_e.labels.minimumPrice} i ${e(g).bindingPeriod??6} ${(pe=e(t))==null?void 0:pe.labels.months} ${e(O)(e(g).minimumPriceDuringTheBindingPeriod)} ${(be=e(t))==null?void 0:be.labels.dkk}`),1)):b("",!0)])])):b("",!0)],2),s("div",null,[s("h2",It,n(w.value.AddOnTitle),1),s("div",{innerHTML:w.value.AddOnText,class:"content__box-subtitle rich-text mt-2 mb-6"},null,8,Bt),s("div",Dt,[(ge=e(c))!=null&&ge.productPackageType&&((fe=e(c))==null?void 0:fe.productPackageType)!=e(z).GREEN?(r(),i("div",{key:0,class:S(["content__box items-center",{"content__box--selected":e(u).motorMagasin}]),onClick:q(Ue,["prevent"])},[s("h3",Et,n(w.value.motorTilsendt),1),s("div",$t,[s("div",Lt,[s("span",Ot," 0 "+n((xe=e(t))==null?void 0:xe.labels.dkk),1)]),T(G,{id:"motorPost",value:e(u).motorMagasin,class:"ml-4"},null,8,["value"])]),s("div",{class:"col-span-2 raw rich-text",innerHTML:w.value.motorTilsendtText},null,8,St)],2)):b("",!0),(r(!0),i(Ie,null,Ge(e(R),o=>{var Pe,Te,we,Ve,Re,Me,Ce;return r(),i("div",{class:S(["content__box items-center",{"content__box--selected":L(o.productId),"content__box--error":L(o.productId)&&!Y.value&&K.value}]),key:o.productId,onClick:Ye=>Ae(Ye,o)},[s("h3",Ut,n(o.name),1),s("div",Ht,[s("div",Ft,[s("span",Kt,[j(n(e(O)(o.price))+" "+n((Pe=e(t))==null?void 0:Pe.labels.dkk),1),(o==null?void 0:o.recurring)===e(V).MONTHLY?(r(),i("span",Yt,"/"+n((Te=e(t))==null?void 0:Te.labels.month),1)):b("",!0),(o==null?void 0:o.recurring)===e(V).YEARLY?(r(),i("span",jt,"/"+n((we=e(t))==null?void 0:we.labels.year),1)):b("",!0)]),o.recurring===e(V).ONE_TIME&&o.price>0?(r(),i("span",zt,n((Ve=e(t))==null?void 0:Ve.labels.oneTimeBenefit),1)):b("",!0),o.minimumPriceDuringTheBindingPeriod?(r(),i("span",Gt,n(`${(Re=e(t))==null?void 0:Re.labels.minimumPrice} i ${o.bindingPeriod??6} ${(Me=e(t))==null?void 0:Me.labels.months} ${e(O)(o.minimumPriceDuringTheBindingPeriod)} ${(Ce=e(t))==null?void 0:Ce.labels.dkk}`),1)):b("",!0)]),T(G,{id:o.productId,value:L(o.productId),class:"ml-4"},null,8,["id","value"])]),s("div",{class:"col-span-2 raw rich-text",innerHTML:o.description},null,8,qt)],10,At)}),128)),s("div",Wt,[!Y.value&&K.value?(r(),i("p",Jt,n((ke=e(t))==null?void 0:ke.labels.addOnSelectionError),1)):b("",!0)])])])])])]),T(Ze,{onNextClicked:Le,onPreviousClicked:Oe,labels:{next:(ye=e(t))==null?void 0:ye.labels.next,previous:(Ne=e(t))==null?void 0:Ne.labels.back},"show-next":!0,"show-previous":!0,"disable-previous":!e(d),"disable-next":Fe.value},null,8,["labels","disable-previous","disable-next"])],64)}}});const ts=ot(Qt,[["__scopeId","data-v-d106977a"]]);export{ts as default};
