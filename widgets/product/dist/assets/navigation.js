import{g as se,h as re,_ as ne,s as G,b as H,i as oe,d as ae,u as ie,P as de,L as A,j as le,v as ue,k as pe}from"./index.js";import{d as S,e as l,f as m,V as q,W as K,H as B,G as g,z as C,D as T,F as b,L as z,N as V,I as F,O as ce,U as x,K as me,r as fe,b as ve,X as he,y as _}from"./embedder.js";const ge={class:"progression-bar"},be={class:"relative"},ke={class:"progression-bar__step-number"},Ce={class:"progression-bar__step-text"},_e=S({__name:"UIProgressBar",props:{steps:{},progressStatus:{}},setup(e){const a=e,n=o=>a.progressStatus>=o+1?"progression-bar__step-divider--completed":"",t=o=>a.progressStatus>o+1?"progression-bar__step-counter--completed":a.progressStatus===o+1?"progression-bar__step-counter--active":"";return(o,u)=>(l(),m("div",ge,[(l(!0),m(q,null,K(a.steps,(k,v)=>(l(),m("div",{key:v,class:"progression-bar__step"},[v!==0?(l(),m("span",{key:0,class:B(["progression-bar__step-divider",n(v)])},null,2)):g("",!0),C("div",be,[C("span",{class:B(["progression-bar__step-counter",t(v)])},[T(se,{class:"progression-bar__step-icon",icon:"check-mark"}),C("span",ke,b(v+1),1)],2),C("span",Ce,b(k),1)])]))),128))]))}}),He=re(_e,[["__scopeId","data-v-3e7fcf37"]]),Ee={class:"footer"},ye={key:0,class:"footer__top-bar"},Le={class:"footer__top-bar-inner"},Ie={class:"footer__main"},we=["href"],Se=["disabled"],Re=["href"],Ae=["disabled"],Te=S({__name:"ProductFooter",props:{labels:{},nextLink:{},previousLink:{},showNext:{type:Boolean},showPrevious:{type:Boolean},disableNext:{type:Boolean},disablePrevious:{type:Boolean},showFooterTopBar:{type:Boolean}},emits:["nextClicked","previousClicked"],setup(e,{emit:a}){const n=a;return(t,o)=>{const u=ce("router-link");return l(),m("footer",Ee,[t.showFooterTopBar?(l(),m("div",ye,[C("div",Le,[z(t.$slots,"default",{},void 0,!0)])])):g("",!0),C("div",Ie,[t.previousLink&&!t.previousLink.startsWith("http")?(l(),V(u,{key:0,to:t.previousLink,class:"fdm-button fdm-button--blue fdm-button--outline w-48 text-center"},{default:F(()=>[x(b(t.labels.previous),1)]),_:1},8,["to"])):g("",!0),t.previousLink&&t.previousLink.startsWith("http")?(l(),m("a",{key:1,href:t.previousLink,class:"fdm-button fdm-button--blue fdm-button--outline w-48 text-center"},b(t.labels.previous),9,we)):g("",!0),t.showPrevious?(l(),m("button",{key:2,onClick:o[0]||(o[0]=k=>n("previousClicked")),disabled:t.disablePrevious,class:"fdm-button fdm-button--blue fdm-button--outline w-48 text-center"},b(t.labels.previous),9,Se)):g("",!0),t.nextLink&&!t.nextLink.startsWith("http")?(l(),V(u,{key:3,to:t.nextLink,disabled:t.disableNext,class:"fdm-button fdm-button--blue w-48 text-center"},{default:F(()=>[x(b(t.labels.next),1)]),_:1},8,["to","disabled"])):g("",!0),t.nextLink&&t.nextLink.startsWith("http")?(l(),m("a",{key:4,href:t.nextLink,class:"fdm-button fdm-button--blue w-48 text-center"},b(t.labels.next),9,Re)):g("",!0),t.showNext?(l(),m("button",{key:5,onClick:o[1]||(o[1]=k=>n("nextClicked")),disabled:t.disableNext,class:"fdm-button fdm-button--blue w-48 text-center"},b(t.labels.next),9,Ae)):g("",!0)])])}}});const qe=ne(Te,[["__scopeId","data-v-48818fa7"]]),Me=S({__name:"UIInfoButton",props:{infoText:{},slideVersion:{}},setup(e){const{popoverContent:a,popoverSlideContent:n,showPopoverSlide:t,showPopover:o}=G(H()),u=e,k=()=>{u.slideVersion?(n.value=u.infoText,t.value=!0):(a.value=u.infoText,o.value=!0)};return(v,E)=>v.infoText?(l(),m("button",{key:0,class:"align-middle",onClick:me(k,["stop","prevent"]),type:"button"},[T(oe,{class:"text-fdm-blue-400 w-5 h-5",icon:"exclamation-circle"})])):g("",!0)}}),Ne={key:0,class:"p-0 mt-1"},Be=S({__name:"UIInputErrors",props:{show:{type:Boolean},errors:{}},setup(e){return(a,n)=>a.show&&a.errors.length?(l(),m("ul",Ne,[(l(!0),m(q,null,K(a.errors,t=>(l(),m("li",{key:t.id,class:"text-fdm-red text-xs font-normal list-none"},b(t.text),1))),128))])):g("",!0)}});var f=(e=>(e.REQUIRED="required",e.LENGTH="length",e.NUMBER="number",e.STRING="string",e.EMAIL="email",e.SOCIAL_SECURITY_NUMBER="social-security-number",e.CHARGE_CHIP_NUMBER="charge-chip-number",e))(f||{});const Ke=(e,a)=>a.find(n=>e===n.id),xe=e=>{let a=e.errors;for(const n of e.types){if(n===f.REQUIRED&&(a=e.input.toString().length?y(n,e):L(n,e)),n===f.LENGTH&&(a=e.input.toString().length===e.requiredLength?y(n,e):L(n,e)),n===f.NUMBER&&(a=/^\d+$/.test(e.input.toString())?y(n,e):L(n,e)),n===f.STRING&&(a=/^[a-zA-Z\s-]+$/g.test(e.input.toString())||e.input.toString()===""?y(n,e):L(n,e)),n===f.EMAIL&&(a=/^\S+@\S+\.\S+$/.test(e.input.toString())?y(n,e):L(n,e)),n===f.SOCIAL_SECURITY_NUMBER){const t=e.input.toString().replace("-",""),o=/^\d+$/.test(t),u=t.length===10;a=o&&u?y(n,e):L(n,e)}n===f.CHARGE_CHIP_NUMBER&&(a=Pe(e.input.toString())?y(n,e):L(n,e))}return a},y=(e,a)=>{const n=a.errors,t=n.findIndex(o=>o.id===e);return t!==-1&&n.splice(t,1),n},L=(e,a)=>{const n=a.errors;let t="";switch(e){case f.REQUIRED:t="Skal udfyldes";break;case f.LENGTH:t=`Skal indeholde ${a.requiredLength} karakterer`;break;case f.NUMBER:t="Må kun indeholde tal";break;case f.STRING:t="Må kun indeholde bogstaver";break;case f.EMAIL:t="Skal indeholde gyldig email";break;case f.SOCIAL_SECURITY_NUMBER:t="Skal indeholde gyldigt cpr-nummer";break;case f.CHARGE_CHIP_NUMBER:t="Skal indeholde gyldigt ladechipnummer";break}return n.find(u=>u.id===e)||n.push({id:e,text:t}),n},ze=e=>new Intl.NumberFormat("da-DK",{minimumFractionDigits:e%1>0?2:0}).format(e),Pe=e=>/^DK-007-(\d{6})-(\w{1})$/.test(e),Oe=["for"],$e={class:"flex items-center"},De={class:"flex w-full"},Ue={key:0,class:"py-3 px-3 text-fdm-gray-500 bg-fdm-gray-200 border-fdm-gray-500 border border-r-0 rounded-l-sm"},Ve=["id","type","name","disabled","placeholder","maxlength","value","pattern"],We=S({__name:"UIInput",props:{id:{},label:{},placeholder:{},infoText:{},maxLength:{},prefix:{},showValidation:{type:Boolean},requiredLength:{},uppercase:{type:Boolean},value:{},name:{},type:{},disabled:{type:Boolean},pattern:{},validationTypes:{}},emits:["inputChanged","inputBlur","validated","enter"],setup(e,{expose:a,emit:n}){const t=fe([]),o=e,u=n;ve(()=>{o.validationTypes&&(t.value=E(o.value))});const k=i=>{let h=i.target.value;u("inputChanged",{value:h,name:o.name}),o.validationTypes&&(t.value=E(h))},v=i=>{let h=i.target.value;u("inputBlur"),o.validationTypes&&(t.value=E(h))},E=i=>{var R;if(!((R=o.validationTypes)!=null&&R.length))return u("validated",{name:o.name,errors:[]}),[];const h={types:o.validationTypes,input:i,errors:t.value};o.requiredLength&&(h.requiredLength=o.requiredLength);const w=xe(h),M=w.map(N=>N.id);return u("validated",{name:o.name,errors:M}),w};return a({validate:()=>{o.validationTypes&&(t.value=E(o.value))}}),(i,h)=>(l(),m("label",{for:i.name,class:"flex flex-col items-start self-start"},[C("span",$e,[x(b(i.label)+" ",1),T(Me,{infoText:i.infoText,slideVersion:"",class:"ml-2"},null,8,["infoText"])]),C("div",De,[i.prefix?(l(),m("span",Ue,b(i.prefix),1)):g("",!0),C("input",{class:B(["fdm-input w-full",[t.value.length&&i.showValidation?"border-fdm-red":"",i.uppercase?"uppercase":"",i.disabled?"disabled:bg-slate-50 disabled:border-slate-400 disabled:shadow-none":""]]),id:i.id,type:i.type,name:i.name,disabled:i.disabled,placeholder:i.placeholder,maxlength:i.maxLength,value:i.value,pattern:i.pattern,onInput:k,onBlur:v,onKeyup:h[0]||(h[0]=he(w=>i.$emit("enter"),["enter"]))},null,42,Ve)]),T(Be,{errors:t.value,show:i.showValidation},null,8,["errors","show"]),z(i.$slots,"default")],8,Oe))}});var I=(e=>(e.FDM="FdmOrderline",e.CLEVER="CleverOrderline",e))(I||{});const Qe=ae("order",()=>{const{addLoadingState:e,removeLoadingState:a}=H(),{order:n,optionalProducts:t,offlineSalesMode:o,orderSalesType:u}=G(ie()),k=["1910006-03A","1910006-05A"],v=_(()=>{const s=[];if(n.value){const r=p(c());r&&r.productlines&&r.productlines.forEach(d=>{t.value.find(U=>d.productId)&&s.push(d.productId)})}return s}),E=_(()=>{const s=[];if(n.value){const r=p(c());r&&r.termsAndConditions&&r.termsAndConditions.forEach(d=>{s.push(parseInt(d.termsCode.toString()))})}return s}),P=_(()=>{const s=p(c());return s?s.motorMagasin:!1}),i=_(()=>{const s=p(c());return s?s.existingCleverCustomer:!1}),h=_(()=>{const s=p(c());return s?s.cleverChargeDiskId??"":""}),w=_(()=>k.some(s=>v.value.includes(s))),M=s=>{if(n.value){const r=p(c());r&&r.productlines.forEach(d=>{d.registrationNumber=s}),s===""&&($(""),D(""))}},R=s=>{const r=t.value.find(d=>d.productId===s);if(r){const d=p(c());d&&(d==null?void 0:d.productlines)==null&&(d.productlines=[]),d==null||d.productlines.push(r)}},N=s=>{const r=p(c());r&&(r.productlines=r.productlines.filter(d=>d.productId!=s))},W=s=>{const r=p(c());r&&(r==null?void 0:r.termsAndConditions)==null&&(r.termsAndConditions=[]),(r==null?void 0:r.termsAndConditions.some(U=>parseInt(U.termsCode)===s))&&O(s),r==null||r.termsAndConditions.push({acceptDate:o.value?void 0:new Date,termsCode:s.toString()})},O=s=>{const r=p(c());r&&(r.termsAndConditions=r==null?void 0:r.termsAndConditions.filter(d=>parseInt(d.termsCode)!==s))},Q=s=>{const r=p(c());r&&(r.motorMagasin=s)},p=s=>{if(n.value){s===I.CLEVER&&te();const r=n.value.orderlines.find(d=>d.type===s);return r&&(r.productlines===void 0&&(r.productlines=[]),r.termsAndConditions===void 0&&(r.termsAndConditions=[])),r}return null},c=()=>{var s;return((s=n.value)==null?void 0:s.productPackageType)===de.GREEN?I.CLEVER:I.FDM},Y=async()=>{try{if(n.value){e(A.UPDATE_ORDER_BASKET);const s=await le(n.value);return n.value=s.order,Promise.resolve(s)}}catch(s){return Promise.reject({type:"updateOrderbasketsAPIError",axios:s})}finally{a(A.UPDATE_ORDER_BASKET)}};async function X(){try{if(n.value){e(A.VALIDATE_ORDER);const s=await ue(n.value);return await pe(),Promise.resolve(s)}else throw new Error("no order stored")}catch(s){return Promise.reject(s)}finally{a(A.VALIDATE_ORDER)}}const Z=s=>{const r=p(c());r&&(r.existingCleverCustomer=s)},J=s=>{const r=p(c());r&&(r.cleverChargeDiskId=s)},j=_(()=>{const s=p(c());return s?s.make??"":""}),ee=_(()=>{const s=p(c());return s?s.model??"":""}),$=s=>{const r=p(c());r&&(r.make=s)},D=s=>{const r=p(c());r&&(r.model=s)},te=()=>{if(n.value&&n.value.orderlines.find(r=>r.type===I.CLEVER)===void 0){const r={type:I.CLEVER,orderlineId:"",productlines:[],termsAndConditions:[],cleverChargeDiskId:"",existingCleverCustomer:!1,make:"",model:"",motorMagasin:!1};n.value.orderlines.push(r)}};return{selectedOptions:v,selectedConsents:E,motorMagasin:P,isExistingCleverMember:i,chargeChipNumber:h,pushAddons:R,removeAddons:N,addConsent:W,removeConsent:O,addOrRemoveMotorMagazine:Q,updateOrderBasket:Y,validateCurrentOrder:X,setRegistrationNumber:M,setExistingCleverMembershipStatus:Z,setChargeChipNumber:J,setCarMake:$,setCarModel:D,getCarMakeInOrder:j,getCarModelInOrder:ee,isChargeChipMandatory:w}}),Ye=({funnelName:e,salesChannel:a,salesType:n,userType:t,stepName:o})=>{window.dataLayer=window.dataLayer||[],window.dataLayer.push({auth:null}),window.dataLayer.push({event:"orderflow",funnel:e,step_name:o,userType:t?"member":"unknown",sales_type:n,sales_channel:a})},Xe=e=>({navigateToNextApp:t=>{if(e.isOfflineMode&&e.crmMessage&&t){t(e.crmMessage);return}window.location.assign(`https://version2-develop.fdm.dk/betaling/?basketId=${e.basketId}&existing=${e.isExistingMember?"1":"0"}`)},navigateToPreviousApp:()=>{const t=e.isOfflineMode?"https://webmembersignupisodev.z16.web.core.windows.net/":`https://version2-develop.fdm.dk/bestil/medlemskab/${e.isExistingMember?"medlemskab":"opret-medlemskab"}`,o=new URL(t);e.basketId&&o.searchParams.append("basketId",e.basketId),window.location.assign(o.toString())}});export{qe as P,f as V,We as _,Xe as a,He as b,Me as c,Be as d,Pe as e,ze as f,Ke as g,Ye as t,Qe as u,xe as v};
